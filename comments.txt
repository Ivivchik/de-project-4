1. По поводу как правильно забирать доставки для каждого ресторана.
    Можно конечно сделать так, что получаемые по api данные по ресторанам класть в x_com и потом оттуда забират и делать запросы по доставкам.
    С другой стороны, а если ресторанов будет много и класть в x_com  например список из 1000 id ресторанов, наверное тоже не правильно(тут могу быть не прав).
    По этому решил сделать так, что сначала записываем id ресторанов в таблицу, и потом при полчение данных по доставкам, читаю эту таблицу и по каждому ресторану делаю запрос по api/deliveries.
    Кажется, что сделал коряво, буду рад если подскажешь как сделать лучше.
2. Добавил в таблицы с ресторанами и курьерами report_dt. Для сохранении истории изменений данных.
    В текущей версии api получаешь только id и name, нет никакой даты апдейта записи на источнике.
    А если поменятся имя ресторана или по api можно будет получать не только имя, а другие данные например меню, адрес и т.д. а даты обновления не будет.
    Поэтому примдумал способ обновления expiration_date и effective_date, только это будет рабоать, если на источнике id у записи остается одно и тоже, меняются только атрибуты.
    Не знаю, так ли это, но навсякий случай написал, возможно сделал лишнюю работу, но все же попрактиковался
3. По поводу того как сделать цикл для забора всех данных с учетом limit в 50 элементов. Попытался сделать что-то типо do while.
    Возможно есть вриант лучше и лаконичнееб, буду рад если подскажешь как можно лучше



По поводу твоего комментария "Иван, может быть попробовать данные по ресторанам, доставкам и курьерам записать в бд в свой stg слой и потом уже провести все эти операции через sql запрос?"
Курьеры и рестораны у меня сейчас сразу льются в бд stg.
На счет доставок не совсем понимаю. Да их можно сразу загрузить в stg, но в данных возращаемых по api нет id ресторана, он указывается только в url.
И если сделать просто загрузку в stg тех данных по доставкам, которые я получаю по api, то как потом разобраться к какому ресторану они относятся ? 


Спасибо за ссылку по airflow)